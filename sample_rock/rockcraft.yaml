name: flask-app
summary: A flask sample app
description: OCI image for the sample flask app
version: "0.1"
base: bare
build-base: ubuntu:22.04
license: Apache-2.0
platforms:
  amd64:

parts:
  flask-environment:
    plugin: nil
    overlay-script: |
      mkdir $CRAFT_OVERLAY/etc
      mkdir $CRAFT_OVERLAY/tmp
      chmod 755 $CRAFT_OVERLAY/etc
      chmod 777 $CRAFT_OVERLAY/tmp
      groupadd -R $CRAFT_OVERLAY --gid 2000 flask
      useradd -R $CRAFT_OVERLAY --system --gid 2000 --uid 2000 --home /srv/flask flask
  flask-dependencies:
    stage-packages:
      - python3-dev
      - python3-flask
      - python3-gunicorn
    plugin: nil
  flask-app:
    plugin: dump
    source: .
    organize:
      sample-app: srv/flask/app
    prime:
      - srv/flask/app
